// Copyright 2006 Google Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
document.createElement("canvas").getContext||(function(){var E=Math,p=E.round,g=E.sin,h=E.cos,R=E.abs,S=E.sqrt,q=10,K=q/2;function T(){return this.context_||(this.context_=new l(this))}var r=Array.prototype.slice;function ab(j,i){var k=r.call(arguments,2);return function(){return j.apply(i,k.concat(r.call(arguments)))}}var t={init:function(j){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var i=j||document;i.createElement("canvas");i.attachEvent("onreadystatechange",ab(this.init_,this,i))}},init_:function(j){j.namespaces.g_vml_||j.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML");j.namespaces.g_o_||j.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");if(!j.styleSheets.ex_canvas_){var i=j.createStyleSheet();i.owningElement.id="ex_canvas_";i.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}var k=j.getElementsByTagName("canvas"),s=0;for(;s<k.length;s++){this.initElement(k[s])}},initElement:function(j){if(!j.getContext){j.getContext=T;j.innerHTML="";j.attachEvent("onpropertychange",ac);j.attachEvent("onresize",a);var i=j.attributes;if(i.width&&i.width.specified){j.style.width=i.width.nodeValue+"px"}else{j.width=j.clientWidth}if(i.height&&i.height.specified){j.style.height=i.height.nodeValue+"px"}else{j.height=j.clientHeight}}return j}};function ac(j){var i=j.srcElement;switch(j.propertyName){case"width":i.style.width=i.attributes.width.nodeValue+"px";i.getContext().clearRect();break;case"height":i.style.height=i.attributes.height.nodeValue+"px";i.getContext().clearRect();break}}function a(j){var i=j.srcElement;if(i.firstChild){i.firstChild.style.width=i.clientWidth+"px";i.firstChild.style.height=i.clientHeight+"px"}}t.init();var u=[],d=0;for(;d<16;d++){var e=0;for(;e<16;e++){u[d*16+e]=d.toString(16)+e.toString(16)}}function o(){return[[1,0,0],[0,1,0],[0,0,1]]}function aa(j,i){var k=o(),s=0;for(;s<3;s++){var v=0;for(;v<3;v++){var A=0,y=0;for(;y<3;y++){A+=j[s][y]*i[y][v]}k[s][v]=A}}return k}function w(j,i){i.fillStyle=j.fillStyle;i.lineCap=j.lineCap;i.lineJoin=j.lineJoin;i.lineWidth=j.lineWidth;i.miterLimit=j.miterLimit;i.shadowBlur=j.shadowBlur;i.shadowColor=j.shadowColor;i.shadowOffsetX=j.shadowOffsetX;i.shadowOffsetY=j.shadowOffsetY;i.strokeStyle=j.strokeStyle;i.globalAlpha=j.globalAlpha;i.arcScaleX_=j.arcScaleX_;i.arcScaleY_=j.arcScaleY_;i.lineScale_=j.lineScale_}function x(j){var i,k=1;j=String(j);if(j.substring(0,3)=="rgb"){var s=j.indexOf("(",3),v=j.indexOf(")",s+1),A=j.substring(s+1,v).split(",");i="#";var y=0;for(;y<3;y++){i+=u[Number(A[y])]}if(A.length==4&&j.substr(3,1)=="a"){k=A[3]}}else{i=j}return{color:i,alpha:k}}function c(i){switch(i){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function l(j){this.m_=o();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.fillStyle=this.strokeStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=q*1;this.globalAlpha=1;this.canvas=j;var i=j.ownerDocument.createElement("div");i.style.width=j.clientWidth+"px";i.style.height=j.clientHeight+"px";i.style.overflow="hidden";i.style.position="absolute";j.appendChild(i);this.element_=i;this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}var n=l.prototype;n.clearRect=function(){this.element_.innerHTML=""};n.beginPath=function(){this.currentPath_=[]};n.moveTo=function(j,i){var k=this.getCoords_(j,i);this.currentPath_.push({type:"moveTo",x:k.x,y:k.y});this.currentX_=k.x;this.currentY_=k.y};n.lineTo=function(j,i){var k=this.getCoords_(j,i);this.currentPath_.push({type:"lineTo",x:k.x,y:k.y});this.currentX_=k.x;this.currentY_=k.y};n.bezierCurveTo=function(j,i,k,s,y,B){var A=this.getCoords_(y,B),C=this.getCoords_(j,i),v=this.getCoords_(k,s);z(this,C,v,A)};function z(j,i,k,s){j.currentPath_.push({type:"bezierCurveTo",cp1x:i.x,cp1y:i.y,cp2x:k.x,cp2y:k.y,x:s.x,y:s.y});j.currentX_=s.x;j.currentY_=s.y}n.quadraticCurveTo=function(j,i,k,s){var v=this.getCoords_(j,i),A=this.getCoords_(k,s),y={x:this.currentX_+0.6666666666666666*(v.x-this.currentX_),y:this.currentY_+0.6666666666666666*(v.y-this.currentY_)};z(this,y,{x:y.x+(A.x-this.currentX_)/3,y:y.y+(A.y-this.currentY_)/3},A)};n.arc=function(j,i,k,s,y,B){k*=q;var A=B?"at":"wa",C=j+h(s)*k-K,v=i+g(s)*k-K,D=j+h(y)*k-K,I=i+g(y)*k-K;if(C==D&&!B){C+=0.125}var F=this.getCoords_(j,i),G=this.getCoords_(C,v),H=this.getCoords_(D,I);this.currentPath_.push({type:A,x:F.x,y:F.y,radius:k,xStart:G.x,yStart:G.y,xEnd:H.x,yEnd:H.y})};n.rect=function(j,i,k,s){this.moveTo(j,i);this.lineTo(j+k,i);this.lineTo(j+k,i+s);this.lineTo(j,i+s);this.closePath()};n.strokeRect=function(j,i,k,s){var v=this.currentPath_;this.beginPath();this.moveTo(j,i);this.lineTo(j+k,i);this.lineTo(j+k,i+s);this.lineTo(j,i+s);this.closePath();this.stroke();this.currentPath_=v};n.fillRect=function(j,i,k,s){var v=this.currentPath_;this.beginPath();this.moveTo(j,i);this.lineTo(j+k,i);this.lineTo(j+k,i+s);this.lineTo(j,i+s);this.closePath();this.fill();this.currentPath_=v};n.createLinearGradient=function(j,i,k,s){var v=new f("gradient");v.x0_=j;v.y0_=i;v.x1_=k;v.y1_=s;return v};n.createRadialGradient=function(j,i,k,s,v,A){var y=new f("gradientradial");y.x0_=j;y.y0_=i;y.r0_=k;y.x1_=s;y.y1_=v;y.r1_=A;return y};n.drawImage=function(j){var i,k,s,A,C,B,D,v,F=j.runtimeStyle.width,M=j.runtimeStyle.height;j.runtimeStyle.width="auto";j.runtimeStyle.height="auto";var G=j.width,H=j.height;j.runtimeStyle.width=F;j.runtimeStyle.height=M;if(arguments.length==3){i=arguments[1];k=arguments[2];C=B=0;D=s=G;v=A=H}else{if(arguments.length==5){i=arguments[1];k=arguments[2];s=arguments[3];A=arguments[4];C=B=0;D=G;v=H}else{if(arguments.length==9){C=arguments[1];B=arguments[2];D=arguments[3];v=arguments[4];i=arguments[5];k=arguments[6];s=arguments[7];A=arguments[8]}else{throw Error("Invalid number of arguments")}}}var L=this.getCoords_(i,k),N=[];N.push(" <g_vml_:group",' coordsize="',q*10,",",q*10,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]){var y=[];y.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",p(L.x/q),",","Dy=",p(L.y/q),"");var I=L,Q=this.getCoords_(i+s,k),O=this.getCoords_(i,k+A),P=this.getCoords_(i+s,k+A);I.x=E.max(I.x,Q.x,O.x,P.x);I.y=E.max(I.y,Q.y,O.y,P.y);N.push("padding:0 ",p(I.x/q),"px ",p(I.y/q),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",y.join(""),", sizingmethod='clip');")}else{N.push("top:",p(L.y/q),"px;left:",p(L.x/q),"px;")}N.push(' ">','<g_vml_:image src="',j.src,'"',' style="width:',q*s,"px;"," height:",q*A,'px;"',' cropleft="',C/G,'"',' croptop="',B/H,'"',' cropright="',(G-C-D)/G,'"',' cropbottom="',(H-B-v)/H,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",N.join(""))};n.stroke=function(j){var i=[],k=x(j?this.fillStyle:this.strokeStyle),s=k.color,C=k.alpha*this.globalAlpha;i.push("<g_vml_:shape",' filled="',!!j,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0 0" coordsize="',q*10," ",q*10,'"',' stroked="',!j,'"',' path="');var H={x:null,y:null},F={x:null,y:null},M=0;for(;M<this.currentPath_.length;M++){var y=this.currentPath_[M];switch(y.type){case"moveTo":i.push(" m ",p(y.x),",",p(y.y));break;case"lineTo":i.push(" l ",p(y.x),",",p(y.y));break;case"close":i.push(" x ");y=null;break;case"bezierCurveTo":i.push(" c ",p(y.cp1x),",",p(y.cp1y),",",p(y.cp2x),",",p(y.cp2y),",",p(y.x),",",p(y.y));break;case"at":case"wa":i.push(" ",y.type," ",p(y.x-this.arcScaleX_*y.radius),",",p(y.y-this.arcScaleY_*y.radius)," ",p(y.x+this.arcScaleX_*y.radius),",",p(y.y+this.arcScaleY_*y.radius)," ",p(y.xStart),",",p(y.yStart)," ",p(y.xEnd),",",p(y.yEnd));break}if(y){if(H.x==null||y.x<H.x){H.x=y.x}if(F.x==null||y.x>F.x){F.x=y.x}if(H.y==null||y.y<H.y){H.y=y.y}if(F.y==null||y.y>F.y){F.y=y.y}}}i.push(' ">');if(j){if(typeof this.fillStyle=="object"){var N=this.fillStyle,V=0,O={x:0,y:0},P=0,U=1;if(N.type_=="gradient"){var Y=N.x1_/this.arcScaleX_,A=N.y1_/this.arcScaleY_,Q=this.getCoords_(N.x0_/this.arcScaleX_,N.y0_/this.arcScaleY_),ag=this.getCoords_(Y,A);V=Math.atan2(ag.x-Q.x,ag.y-Q.y)*180/Math.PI;if(V<0){V+=360}if(V<1e-06){V=0}}else{var Q=this.getCoords_(N.x0_,N.y0_),ae=F.x-H.x,af=F.y-H.y;O={x:(Q.x-H.x)/ae,y:(Q.y-H.y)/af};ae/=this.arcScaleX_*q;af/=this.arcScaleY_*q;var W=E.max(ae,af);P=2*N.r0_/W;U=2*N.r1_/W-P}var ad=N.colors_;ad.sort(function(ah,ai){return ah.offset-ai.offset});var I=ad.length,v=ad[0].color,B=ad[I-1].color,D=ad[0].alpha*this.globalAlpha,G=ad[I-1].alpha*this.globalAlpha,X=[],M=0;for(;M<I;M++){var Z=ad[M];X.push(Z.offset*U+P+" "+Z.color)}i.push('<g_vml_:fill type="',N.type_,'"',' method="none" focus="100%"',' color="',v,'"',' color2="',B,'"',' colors="',X.join(","),'"',' opacity="',G,'"',' g_o_:opacity2="',D,'"',' angle="',V,'"',' focusposition="',O.x,",",O.y,'" />')}else{i.push('<g_vml_:fill color="',s,'" opacity="',C,'" />')}}else{var L=this.lineScale_*this.lineWidth;if(L<1){C*=L}i.push("<g_vml_:stroke",' opacity="',C,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',c(this.lineCap),'"',' weight="',L,'px"',' color="',s,'" />')}i.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",i.join(""))};n.fill=function(){this.stroke(true)};n.closePath=function(){this.currentPath_.push({type:"close"})};n.getCoords_=function(j,i){var k=this.m_;return{x:q*(j*k[0][0]+i*k[1][0]+k[2][0])-K,y:q*(j*k[0][1]+i*k[1][1]+k[2][1])-K}};n.save=function(){var i={};w(this,i);this.aStack_.push(i);this.mStack_.push(this.m_);this.m_=aa(o(),this.m_)};n.restore=function(){w(this.aStack_.pop(),this);this.m_=this.mStack_.pop()};function m(j){var i=0;for(;i<3;i++){var k=0;for(;k<2;k++){if(!isFinite(j[i][k])||isNaN(j[i][k])){return false}}}return true}function b(j,i,k){if(!!m(i)){j.m_=i;if(k){j.lineScale_=S(R(i[0][0]*i[1][1]-i[0][1]*i[1][0]))}}}n.translate=function(j,i){b(this,aa([[1,0,0],[0,1,0],[j,i,1]],this.m_),false)};n.rotate=function(j){var i=h(j),k=g(j);b(this,aa([[i,k,0],[-k,i,0],[0,0,1]],this.m_),false)};n.scale=function(j,i){this.arcScaleX_*=j;this.arcScaleY_*=i;b(this,aa([[j,0,0],[0,i,0],[0,0,1]],this.m_),true)};n.transform=function(j,i,k,s,v,y){b(this,aa([[j,i,0],[k,s,0],[v,y,1]],this.m_),true)};n.setTransform=function(j,i,k,s,v,y){b(this,[[j,i,0],[k,s,0],[v,y,1]],true)};n.clip=function(){};n.arcTo=function(){};n.createPattern=function(){return new J};function f(i){this.type_=i;this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0;this.colors_=[]}f.prototype.addColorStop=function(j,i){i=x(i);this.colors_.push({offset:j,color:i.color,alpha:i.alpha})};function J(){}G_vmlCanvasManager=t;CanvasRenderingContext2D=l;CanvasGradient=f;CanvasPattern=J})();